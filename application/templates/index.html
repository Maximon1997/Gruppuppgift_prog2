<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <title>Personal Finance Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <style>
    body { background-color: #f8f9fa; }
    h1, h2 { font-weight: 700; }
    td.positive { color: #0f5132; background: #d1e7dd33; }
    td.negative { color: #842029; background: #f8d7da33; }
  </style>
</head>
<body>

  <!-- ðŸ”¹ Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4 shadow-sm">
    <div class="container">
      <a class="navbar-brand fw-bold d-flex align-items-center gap-2" href="/">
        <span class="bg-light text-dark px-3 py-1 rounded-3 shadow-sm">
          ðŸ“ˆ World Wide Stocks
        </span>
      </a>
      <span class="text-light small ms-2">Stock App</span>
    </div>
  </nav>

  <!-- ðŸ”¹ HuvudinnehÃ¥ll -->
  <div class="container mb-5">
    <div class="card shadow-sm border-0">
      <div class="card-body">
        <h1 class="mb-3">Personal Finance Dashboard</h1>
        <p class="text-muted mb-4">SÃ¶k efter aktiedata och se resultat i olika valutor.</p>

        <!-- FormulÃ¤r (ofÃ¶rÃ¤ndrat) -->
        <form action="/results" method="POST">
          <div class="mb-3">
            <label for="stock" class="form-label">Aktiesymbol (t.ex. AAPL, TSLA):</label>
            <input type="text" id="stock" name="stock"
                   value="{{ form_data.get('stock', '') }}"
                   class="form-control" required>
          </div>
<!-- Dropdown fÃ¶r bas valuta-->
          <div class="mb-3"> 
            <label for="currency" class="form-label">Basvaluta:</label>
            <select id="currency" name="currency" class="form-select" required>
              {% set saved_currency = form_data.get('currency', '') %}
              <option value="USD" {% if saved_currency == 'USD' %}selected{% endif %}>USD</option>
              <option value="EUR" {% if saved_currency == 'EUR' %}selected{% endif %}>EUR</option>
              <option value="SEK" {% if saved_currency == 'SEK' %}selected{% endif %}>SEK</option>
              <option value="GBP" {% if saved_currency == 'GBP' %}selected{% endif %}>GBP</option>
            </select>
          </div>


          <button type="submit" class="btn btn-primary">Visa resultat</button>
        </form>
      </div>
    </div>

    <!-- ðŸ”¹ Resultat -->
    <div class="row mt-4 g-4">
      <div class="col-md-6">
        <div class="card h-100 shadow-sm">
          <div class="card-header bg-success text-white">StÃ¶rsta vinnarna</div>
          <div class="card-body table-responsive">
            {{ gainers_table|safe }}
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="card h-100 shadow-sm">
          <div class="card-header bg-danger text-white">StÃ¶rsta fÃ¶rlorarna</div>
          <div class="card-body table-responsive">
            {{ losers_table|safe }}
          </div>
        </div>
      </div>
    </div>

    <footer class="text-center text-muted py-4 mt-5 border-top">
      Â© 2025 Nackademin
    </footer>
  </div>

  <!-- ðŸ”¹ FÃ¤rgmarkering fÃ¶r positiva och negativa vÃ¤rden -->
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      document.querySelectorAll("td").forEach(td => {
        const text = td.textContent.trim();
        if (text.endsWith("%")) {
          const value = parseFloat(text.replace("%", ""));
          if (!isNaN(value)) {
            if (value > 0) td.classList.add("positive");
            else if (value < 0) td.classList.add("negative");
          }
        }
      });
    });
  </script>
</body>
</html>
